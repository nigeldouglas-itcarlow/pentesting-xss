# Cross Site Scripting (XSS) Penetration Testing
The goal is to fix 11 PHP webpages that could easily be exploited by Cross-Site Scripting (XSS).

| XSS Vulnerability  | Source PHP | Fixed PHP Code | Description of Change |
| ------------- | ------------- | ------------- | ------------- |
| Reflective XSS Over GET  | [Lab01.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/lab01.php)  | [lab01-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab01-fixed.php)  | The code first uses htmlspecialchars to escape HTML entities in the user-provided input stored in the "name" parameter, preventing the execution of any HTML or script tags. Then, it echoes the sanitized input, ensuring that any potential XSS payloads are displayed as harmless text rather than being executed as code.  |
| Reflective XSS Over GET  | [Lab02.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab02.php)  | [Lab02-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/Lab02-fixed.php)  | These two lines of code use htmlspecialchars with the ENT_QUOTES flag and specify the character encoding as UTF-8 to escape both single and double quotes in the user-provided input, making it resistant to HTML and attribute-based XSS attacks. Then, it echoes the sanitized input, ensuring that any potential XSS payloads are displayed as harmless text rather than being executed as code.  |
| Reflective XSS Over GET  | [Lab03.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab03.php)  | [lab03-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab03-fixed.php)  | Lab3.php is identical to Lab2.php. Not sure if this was done in error.  |
| Reflective XSS Over GET  | [Lab04.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab04.php)  | [lab04-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab04-fixed.php)  | This code first uses strip_tags to remove any HTML tags from the user input, allowing only specified safe tags like <b >, <i >, <u >, and <p > to remain. Then, it applies htmlspecialchars with the ENT_QUOTES flag and UTF-8 encoding to escape special characters, ensuring that even if tags are present, they won't be executed as code, effectively preventing XSS payloads.  |
| Reflective XSS Over GET  | [Lab05.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab05.php)  | [lab05-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab05-fixed.php)  | Content Cell  |
| Reflective XSS Over POST  | [Lab06.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab06.php)  | [lab06-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab06-fixed.php)  | Content Cell  |
| DOM XSS Over HTTP GET  | [Lab07.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab07.php)  | [lab07-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab07-fixed.php)  | Content Cell  |
| Reflective XSS Over POST  | [Lab08.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab08.php)  | [lab08-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab08-fixed.php)  | Content Cell  |
| Reflective XSS Over GET  | [Lab09.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab09.php)  | [lab09-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab09-fixed.php)  | Content Cell  |
| Reflective XSS Over POST  | [Lab10.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab10.php)  | [lab10-fixed.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/lab10-fixed.php)  | Content Cell  |
| Reflective XSS Over GET  | [Lab11.php](https://github.com/nigeldouglas-itcarlow/pentesting-xss/blob/main/original-src-files/Lab11.php) | lab11-fixed.php  | Content Cell  |

I had to compare the manual findings with those identified in my OWASP Zap report. <br/>
However, I'm still unsure how to use the findings of this tool to mitigate XSS attacks:

![zap-report1](https://github.com/nigeldouglas-itcarlow/pentesting-xss/assets/126002808/5555a3f7-dc59-46f4-9ce1-4c17005281d4)
